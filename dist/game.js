(()=>{"use strict";class e{constructor(e){this.maxspeed=5,this.speedY=5,this.width=15,this.height=15,this.player=e,this.position={x:this.player.position.x+e.width/2,y:this.player.position.y}}}class t{constructor(e){this.health=3,this.tempx=Math.floor(Math.random()*e),this.tempx>e-this.width&&(tempx=e-this.width),this.position={x:this.tempx,y:0},this.height=30,this.width=30,this.speedY=2}}const i=document.getElementById("game_screen").getContext("2d"),s=document.getElementById("button"),o=document.getElementById("b_label"),h=document.getElementById("side_screen").getContext("2d"),a=document.getElementById("control_pics").getContext("2d"),n=new Image;n.src="game/assets/images/projectile.png";const l=new Image;l.src="game/assets/images/person.png",(new Image).src="game/assets/images/tileset.png";const p=new Image;p.src="game/assets/images/lose_message.png";const r=new Image;r.src="game/assets/images/controls.png";const c=new Image;c.src="game/assets/images/enemies.png";const d=450,m=720;let g=new class{constructor(e,t){this.width=30,this.height=30,this.img_width=875,this.img_height=745,this.img_position_x=680,this.img_position_y=260,this.gameWidth=e,this.gameHeight=t,this.position={x:e/2-this.width/2,y:t-this.height-10},this.maxSpeed=5,this.Xspeed=0,this.Yspeed=0,this.lives=3,this.score=0}draw_lives(e,t){for(let i=0;i<this.lives;i+=1)e.drawImage(t,this.img_position_x,this.img_position_y,this.img_width,this.img_height,60*i,50,50,50)}draw(e,t){e.drawImage(t,this.img_position_x,this.img_position_y,this.img_width,this.img_height,this.position.x,this.position.y,this.width,this.height)}update(e){e&&(this.position.x+=this.Xspeed,this.position.y+=this.Yspeed,this.position.x<=0&&(this.position.x=0),this.position.x>=this.gameWidth-this.width&&(this.position.x=this.gameWidth-this.width),this.position.y<=0&&(this.position.y=0),this.position.y>=this.gameHeight-this.height&&(this.position.y=this.gameHeight-this.height))}moveLeft(){this.Xspeed=-this.maxSpeed}moveUp(){this.Yspeed=-this.maxSpeed}moveRight(){this.Xspeed=this.maxSpeed}moveDown(){this.Yspeed=this.maxSpeed}stopX(){this.Xspeed=0}stopY(){this.Yspeed=0}reset(){this.lives=3,this.score=0,this.position={x:this.gameWidth/2-this.width/2,y:this.gameHeight-this.height-10}}}(d,m),w=new class{projectiles=[];timerTillNextProjectile=0;constructor(e){this.player=e}draw(e,t,i){if(t.position.y<=0){let e=this.projectiles.indexOf(t);this.projectiles.splice(e,1)}else{let s=550,o=570;e.drawImage(i,0,0,s,o,t.position.x-t.width/2,t.position.y,t.width,t.height)}}update(e,t){e&&(t.position.y-=t.maxspeed)}shoot(){this.timerTillNextProjectile<=0&&this.projectiles.push(new e(this.player))}reset(){this.projectiles=[],this.timerTillNextProjectile=0}}(g),y=new class{constructor(e,t){this.enemies=[],this.GAME_HEIGHT=t,this.GAME_WIDTH=e,this.default_delay=150,this.spawn_delay=150}draw(e,t,i,s){if(t.position.y>=this.GAME_HEIGHT){let e=this.enemies.indexOf(t);this.enemies.splice(e,1),i.lives-=1}else switch(t.health){case 3:e.drawImage(s,130,120,670,632,t.position.x,t.position.y,t.width,t.height);break;case 2:e.drawImage(s,860,120,670,632,t.position.x,t.position.y,t.width,t.height);break;case 1:e.drawImage(s,1588,120,692,632,t.position.x,t.position.y,t.width,t.height)}}update(e,t){e&&(t.position.y+=t.speedY)}spawn(){0==this.spawn_delay&&(this.enemies.push(new t(this.GAME_WIDTH)),this.spawn_delay=this.default_delay,30!=this.default_delay&&(this.default_delay-=3)),this.spawn_delay-=1}reset(){this.enemies=[],this.default_delay=150,this.spawn_delay=150}}(d,m),_=new class{constructor(e,t){this.projectile_controller=e,this.enemy_controller=t}enemy_projectile_collision(e){this.projectile_controller.projectiles.forEach((t=>{this.enemy_controller.enemies.forEach((i=>{if(t.position.y<=i.position.y+i.height&&t.position.x+t.width>=i.position.x&&t.position.x<=i.position.x+i.width){let s=this.projectile_controller.projectiles.indexOf(t),o=this.enemy_controller.enemies.indexOf(i);1==i.health?(e.score+=100,this.projectile_controller.projectiles.splice(s,1),this.enemy_controller.enemies.splice(o,1)):(i.health-=1,this.projectile_controller.projectiles.splice(s,1))}}))}))}}(w,y),x=0;function u(e){let t=e-x;if(x=e,0==g.lives)return h.clearRect(0,0,400,150),h.fillText("Score:",0,75),h.fillText(g.score,0,105),i.clearRect(0,0,d,m),i.drawImage(p,490,580,1295,195,0,260,431,65),o.style="display: block; margin-top: 10vh; margin-left: 4vw;",void(o.innerHTML="<img src='game/assets/images/again_image.png' alt='no pic' style='height: 161px; width: 182px;'>");a.drawImage(r,150,230,1415,580,0,0,353,145),i.clearRect(0,0,d,m),h.clearRect(0,0,400,150),h.fillStyle="white",h.font="20px Arial",h.fillText("Lives",0,20,100),h.font="30px Arial",h.fillText(g.score,0,150,100),g.update(t),g.draw(i,l),g.draw_lives(h,l),y.spawn(),y.enemies.forEach((e=>{y.draw(i,e,g,c),y.update(t,e)})),w.projectiles.forEach((e=>{w.draw(i,e,n),w.update(t,e)})),_.enemy_projectile_collision(g),requestAnimationFrame(u)}new class{constructor(e,t,i){document.addEventListener("keydown",(t=>{switch(t.keyCode){case 37:case 65:e.moveLeft();break;case 38:case 87:e.moveUp();break;case 39:case 68:e.moveRight();break;case 40:case 83:e.moveDown()}})),document.addEventListener("keydown",(e=>{switch(e.keyCode){case 80:case 32:t.shoot()}})),document.addEventListener("keyup",(t=>{switch(t.keyCode){case 37:case 65:e.Xspeed<0&&e.stopX();break;case 38:case 87:e.Yspeed<0&&e.stopY();break;case 39:case 68:e.Xspeed>0&&e.stopX();break;case 40:case 83:e.Yspeed>0&&e.stopY()}}))}}(g,w,s),s.addEventListener("click",(function(e){o.style="display: none",g.reset(),y.reset(),w.reset(),g.draw(i,l),u()}))})();